<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"/>

  <meta name="description" content="사용자 로그인을 손본다. 주로 뷰를 깔끔하게 다듬는 내용을 담고 있다."/>
  <meta name="google-site-verification" content="ToXKBimREnz49pDNot4b-N9ZJgYcKXPPsHsjhg4Zzuc"/>
  <meta name="naver-site-verification" content="7cebcc8e5493169f5401870d9ce57f48d18491cd"/>

  <meta name="msapplication-tap-highlight" content="no"/>

  <!-- Facebook Meta -->
  <meta property="og:title" content="라라벨 5 입문 및 실전 / 32강 - 사용자 로그인"/>
  <meta property="og:type" content="Website"/>
  <meta property="og:author" content="appkr (juwonkim@me.com)"/>
  <meta property="og:image" content=""/>

  <!-- Google+ Meta -->
  <meta itemprop="name" content="라라벨 5 입문 및 실전 / 32강 - 사용자 로그인">
  <meta itemprop="description" content="사용자 로그인을 손본다. 주로 뷰를 깔끔하게 다듬는 내용을 담고 있다.">
  <meta itemprop="image" content="">
  <meta itemprop="author" content="appkr (juwonkim@me.com)"/>

  <!-- Twitter Meta -->
  <meta name="twitter:card" content="summary"/>
  <meta name="twitter:site" content="@appkrs"/>
  <meta name="twitter:title" content="라라벨 5 입문 및 실전 / 32강 - 사용자 로그인"/>
  <meta name="twitter:description" content="사용자 로그인을 손본다. 주로 뷰를 깔끔하게 다듬는 내용을 담고 있다."/>
  <meta name="twitter:image" content=""/>
  <meta name="twitter:domain" content="http://l5.appkr.kr/">

  <!-- Mobile and Rss -->
  <link rel="canonical" href="http://l5.appkr.kr/"/>

  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Roboto:300,400,500,700"/>
  <link rel="stylesheet" href="//fonts.googleapis.com/earlyaccess/nanumgothic.css"/>
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons"/>
  <link rel="stylesheet" href="/css/main.css">

  <title>라라벨 5 입문 및 실전 / 32강 - 사용자 로그인</title>

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
  <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>
<body id="#app">
  <nav class="navbar navbar-fixed-top role="navigation">

  <div class="container-fluid">
    <div class="navbar-header">
      <a href="/" class="navbar-brand">
        <i class="material-icons">school</i>
        라라벨 5 입문 및 실전
      </a>
    </div>
  </div>
</nav>
  <div class="container">
    <div class="row">
      <aside id="sidebar" class="col-md-3">
        <ul>
                      <li  index="0" current-index="33">
              <a href="/lessons/01-welcome.html">1강 - 처음 만나는 라라벨</a>
            </li>
                      <li  index="1" current-index="33">
              <a href="/lessons/02-hello-laravel.html">2강 - 라라벨 5 설치하기</a>
            </li>
                      <li  index="2" current-index="33">
              <a href="/lessons/02-install-on-windows.html">2강 - 라라벨 5 설치하기 (on Windows)</a>
            </li>
                      <li  index="3" current-index="33">
              <a href="/lessons/03-configuration.html">3강 - 글로벌 설정 살펴보기</a>
            </li>
                      <li  index="4" current-index="33">
              <a href="/lessons/04-routing-basics.html">4강 - Routing 기본기</a>
            </li>
                      <li  index="5" current-index="33">
              <a href="/lessons/05-pass-data-to-view.html">5강 - 뷰에 데이터 바인딩하기</a>
            </li>
                      <li  index="6" current-index="33">
              <a href="/lessons/06-blade-101.html">6강 - 블레이드 101</a>
            </li>
                      <li  index="7" current-index="33">
              <a href="/lessons/07-blade-201.html">7강 - 블레이드 201</a>
            </li>
                      <li  index="8" current-index="33">
              <a href="/lessons/08-raw-queries.html">8강 - 날 쿼리 :(</a>
            </li>
                      <li  index="9" current-index="33">
              <a href="/lessons/09-query-builder.html">9강 - 쿼리 빌더</a>
            </li>
                      <li  index="10" current-index="33">
              <a href="/lessons/10-eloquent.html">10강 - 엘로퀀트 ORM</a>
            </li>
                      <li  index="11" current-index="33">
              <a href="/lessons/11-migration.html">11강 - DB 마이그레이션</a>
            </li>
                      <li  index="12" current-index="33">
              <a href="/lessons/12-controller.html">12강 - 컨트롤러</a>
            </li>
                      <li  index="13" current-index="33">
              <a href="/lessons/13-restful-resource-controller.html">13강 - RESTful 리소스 컨트롤러</a>
            </li>
                      <li  index="14" current-index="33">
              <a href="/lessons/14-named-routes.html">14강 - 이름 있는 Route</a>
            </li>
                      <li  index="15" current-index="33">
              <a href="/lessons/15-nested-resources.html">15강 - 중첩된 리소스</a>
            </li>
                      <li  index="16" current-index="33">
              <a href="/lessons/16-authentication.html">16강 - 사용자 인증 기본기</a>
            </li>
                      <li  index="17" current-index="33">
              <a href="/lessons/17-authentication-201.html">17강 - 라라벨에 내장된 사용자 인증</a>
            </li>
                      <li  index="18" current-index="33">
              <a href="/lessons/18-eloquent-relationships.html">18강 - 모델간 관계 맺기</a>
            </li>
                      <li  index="19" current-index="33">
              <a href="/lessons/19-seeder.html">19강 - 데이터 심기</a>
            </li>
                      <li  index="20" current-index="33">
              <a href="/lessons/20-eager-loading.html">20강 - Eager 로딩</a>
            </li>
                      <li  index="21" current-index="33">
              <a href="/lessons/20-1-pagination.html">추가 - 페이징</a>
            </li>
                      <li  index="22" current-index="33">
              <a href="/lessons/21-mail.html">21강 - 메일 보내기</a>
            </li>
                      <li  index="23" current-index="33">
              <a href="/lessons/22-events.html">22강 - 이벤트</a>
            </li>
                      <li  index="24" current-index="33">
              <a href="/lessons/23-validation.html">23강 - 입력 값 유효성 검사</a>
            </li>
                      <li  index="25" current-index="33">
              <a href="/lessons/24-exception-handling.html">24강 - 예외 처리</a>
            </li>
                      <li  index="26" current-index="33">
              <a href="/lessons/25-composer.html">25강 - 컴포저</a>
            </li>
                      <li  index="27" current-index="33">
              <a href="/lessons/26-document-model.html">26강 - Document 모델</a>
            </li>
                      <li  index="28" current-index="33">
              <a href="/lessons/27-document-controller.html">27강 - Document 컨트롤러</a>
            </li>
                      <li  index="29" current-index="33">
              <a href="/lessons/28-cache.html">28강 - Cache</a>
            </li>
                      <li  index="30" current-index="33">
              <a href="/lessons/29-elixir.html">29강 - Elixir, 만병통치약?</a>
            </li>
                      <li  index="31" current-index="33">
              <a href="/lessons/30-final-touch.html">30강 - Debug &amp; Final Touch</a>
            </li>
                      <li  index="32" current-index="33">
              <a href="/lessons/31-forum-features.html">31강 - 포럼 요구사항 기획</a>
            </li>
                      <li class="active" index="33" current-index="33">
              <a href="/lessons/32-login.html">32강 - 사용자 로그인</a>
            </li>
                      <li  index="34" current-index="33">
              <a href="/lessons/33-social-login.html">33강 - 소셜 로그인</a>
            </li>
                      <li  index="35" current-index="33">
              <a href="/lessons/34-role.html">34강 - 사용자 역할</a>
            </li>
                      <li  index="36" current-index="33">
              <a href="/lessons/35-locale.html">35강 - 다국어 지원</a>
            </li>
                      <li  index="37" current-index="33">
              <a href="/lessons/36-models.html">36강 - 마이그레이션과 모델</a>
            </li>
                      <li  index="38" current-index="33">
              <a href="/lessons/37-articles.html">37강 - Article 기능 구현</a>
            </li>
                      <li  index="39" current-index="33">
              <a href="/lessons/38-tags.html">38강 - Tag 기능 구현</a>
            </li>
                      <li  index="40" current-index="33">
              <a href="/lessons/39-attachments.html">39강 - Attachment 기능 구현</a>
            </li>
                      <li  index="41" current-index="33">
              <a href="/lessons/32n33-auth-refactoring.html">32/33 보충 - 인증 리팩토링</a>
            </li>
                      <li  index="42" current-index="33">
              <a href="/lessons/40-comments.html">40강 - Comment 기능 구현</a>
            </li>
                      <li  index="43" current-index="33">
              <a href="/lessons/41-ui-makeup.html">41강 - UI 개선</a>
            </li>
                      <li  index="44" current-index="33">
              <a href="/lessons/42-be-makeup.html">42강 - 서버 사이드 개선</a>
            </li>
                      <li  index="45" current-index="33">
              <a href="/lessons/43-change-note.html">43강 - 변경 사항 알림</a>
            </li>
                      <li  index="46" current-index="33">
              <a href="/lessons/44-api-basic.html">44강 - API 기본기 및 기획</a>
            </li>
                      <li  index="47" current-index="33">
              <a href="/lessons/45-api-big-picture.html">45강 - 기본 구조 잡기</a>
            </li>
                      <li  index="48" current-index="33">
              <a href="/lessons/46-jwt.html">46강 - JWT 를 이용한 인증</a>
            </li>
                      <li  index="49" current-index="33">
              <a href="/lessons/47-dry-refactoring.html">47강 - 중복 제거 리팩토링</a>
            </li>
                      <li  index="50" current-index="33">
              <a href="/lessons/48-all-is-bad.html">48강 - all() is bad</a>
            </li>
                      <li  index="51" current-index="33">
              <a href="/lessons/49-rate-limit.html">49강 - API Rate Limit</a>
            </li>
                      <li  index="52" current-index="33">
              <a href="/lessons/50-id-obfuscation.html">50강 - 리소스 id 난독화</a>
            </li>
                      <li  index="53" current-index="33">
              <a href="/lessons/51-cors.html">51강 - CORS</a>
            </li>
                      <li  index="54" current-index="33">
              <a href="/lessons/52-caching.html">52강 - Caching</a>
            </li>
                      <li  index="55" current-index="33">
              <a href="/lessons/53-partial-response.html">53강 - Partial Response</a>
            </li>
                      <li  index="56" current-index="33">
              <a href="/lessons/54-api-docs.html">54강 - API Documents</a>
            </li>
                      <li  index="57" current-index="33">
              <a href="/lessons/02-install-homestead-osx.html">Homestead 설치 (on Mac)</a>
            </li>
                      <li  index="58" current-index="33">
              <a href="/lessons/02-install-homestead-windows.html">Homestead 설치 (on Windows)</a>
            </li>
                      <li  index="59" current-index="33">
              <a href="/lessons/999-code-release.html">코드 배포</a>
            </li>
                  </ul>
      </aside>

      <div class="col-md-9">
        <article id="article">
                      <nav id="pagination">
  <ul class="pager pager-top">
    <li class="previous ">
      <a href="/lessons/31-forum-features.html">
        <span class="pager-title-sm">
          <i class="material-icons">keyboard_arrow_left</i>
        </span>
        <span class="pager-title">
          31강 - 포럼 요구사항...
        </span>
      </a>
    </li>
    <li class="next ">
      <a href="/lessons/33-social-login.html">
        <span class="pager-title">
          33강 - 소셜 로그인
        </span>
        <span class="pager-title-sm">
          <i class="material-icons">keyboard_arrow_right</i>
        </span>
      </a>
    </li>
  </ul>
</nav>
            <hr/>

            <h1>실전 프로젝트 2 - Forum</h1>
<p>실습을 진행하기 전에 기존에 만들었던 파일 중, 쓰지 않을 파일이나, 쓰지 않을 코드 블럭들을 삭제할 것을 권장한다. 정리하지 않아도 무방하긴 하지만...</p>
<h2>32강 - 사용자 로그인</h2>
<p>기본기 16강, 17강에서 배운 내용을 기반으로 사용자 로그인 기능을 만들어 보자. 여러개로 쪼개기도 뭣 하고... 그리고, 진도를 좀 많이 빼기 위해, 이번 강좌에서 욕심을 좀 냈으니 지치지 말고 따라해 주기 바란다.</p>
<h3>Route 정의</h3>
<p>app/Http/routes.php에 사용자 등록, 로그인/아웃, 비밀번호 초기화, 홈페이지, 로그인 후 이동할 페이지 등에 사용할 엔드포인트를 먼저 만들자. 서비스에 사용할 수 있을 만큼의 퀄리티를 내기 위해 이번 강좌부터는 코드량이 좀 많다.</p>
<pre><code class="language-php">Route::get('/', [
    'as' =&gt; 'root',
    'uses' =&gt; 'WelcomeController@index'
]);

Route::get('home', [
    'as' =&gt; 'home',
    'uses' =&gt; 'WelcomeController@home'
]);

/* User Registration */
Route::group(['prefix' =&gt; 'auth', 'as' =&gt; 'user.'], function () {
    Route::get('register', [
        'as'   =&gt; 'create',
        'uses' =&gt; 'Auth\AuthController@getRegister'
    ]);
    Route::post('register', [
        'as'   =&gt; 'store',
        'uses' =&gt; 'Auth\AuthController@postRegister'
    ]);
});

/* Session */
Route::group(['prefix' =&gt; 'auth', 'as' =&gt; 'session.'], function () {
    Route::get('login', [
        'as'   =&gt; 'create',
        'uses' =&gt; 'Auth\AuthController@getLogin'
    ]);
    Route::post('login', [
        'as'   =&gt; 'store',
        'uses' =&gt; 'Auth\AuthController@postLogin'
    ]);
    Route::get('logout', [
        'as'   =&gt; 'destroy',
        'uses' =&gt; 'Auth\AuthController@getLogout'
    ]);
});

/* Password Reminder */
Route::group(['prefix' =&gt; 'password'], function () {
    Route::get('remind', [
        'as'   =&gt; 'reminder.create',
        'uses' =&gt; 'Auth\PasswordController@getEmail'
    ]);
    Route::post('remind', [
        'as'   =&gt; 'reminder.store',
        'uses' =&gt; 'Auth\PasswordController@postEmail'
    ]);
    Route::get('reset/{token}', [
        'as'   =&gt; 'reset.create',
        'uses' =&gt; 'Auth\PasswordController@getReset'
    ]);
    Route::post('reset', [
        'as'   =&gt; 'reset.store',
        'uses' =&gt; 'Auth\PasswordController@postReset'
    ]);
});</code></pre>
<p><code>Route::group()</code>은 여러개의 Route에 공통된 Prefix Url, Route Name을 붙이거나, 미들웨어를 동시에 적용할 때 사용할 수 있다. 여기에 사용한 모든 컨트롤러와 메소드는 라라벨 기본으로 내장되어 배포되는 <code>App\Http\Controllers\Auth\AuthController</code>, <code>App\Http\Controllers\Auth\PasswordController</code>의 것을 그대로 사용한 것이다.</p>
<p>app/Http/Controllers/WelcomeController.php 는 별도로 만들어 주고, Route 와 연결된 메소드를 써 주어야 한다.</p>
<pre><code class="language-bash">$ php artisan make:controller WelcomeController</code></pre>
<pre><code class="language-php">&lt;?php

namespace App\Http\Controllers;

use App\Http\Requests;

class WelcomeController extends Controller
{
    public function __construct()
    {
        $this-&gt;middleware('auth', ['only' =&gt; ['home']]);
    }

    public function index()
    {
        return view('index');
    }

    public function home()
    {
        return view('home');
    }
}</code></pre>
<p>16~17강에서 'auth' 미들웨어를 배운것을 떠올려 보자. <code>Route::get('url', ['middleware' =&gt; 'auth', ...]);</code> 식으로 썼을 것이다. Route 대신 컨트롤러에서 메소드별로 미들웨어를 적용할 수 있는데, 위 예와 같이 생성자 메소드에서 <code>$this-&gt;middleware('middleware-to-use')</code> 식으로 쓴다. 그리고, 두번째 인자로 <code>only</code> 키워드를 사용했는데, 지정된 메소드에서만 이 미들웨어를 적용하겠단 의미이다. 즉, 여기서는 <code>home()</code> 메소드에 접근하기전에 'auth' 미들웨어를 거쳐야 하고, 'auth' 미들웨어에 의해 로그인되어 있지 않을 경우, 'auth/login' Route 로 이동하게 된다. </p>
<p>Route가 잘 정의되었는지 확인해 보자. 에러가 안났다는 것은 엔드포인트와 컨트롤러의 메소드가 잘 연결되었다는 의미이다. </p>
<pre><code class="language-bash">$ php artisan route:list</code></pre>
<p><img src="./images/32-login-img-01.png" alt="" /></p>
<h3>마스터 템플릿을 손보자!</h3>
<p>먼저, 뷰 디렉토리를 좀 더 구조화 하기 위해, 기존의 master.blade.php 파일은 resources/views/layouts/master.blade.php 로 이동하였다.</p>
<p>좀 더 있어 보이는 레이아웃을 위해 <a href="http://getbootstrap.com/getting-started/">Bootstrap 사이트</a>에서 괜찮은 템플릿을 좀 훔쳐와서, resources/views/layouts/master.blade.php 에 적용해 보았다. 구조화를 위해 navigation.blade.php, footer.blade.php 로 내용을 좀 나누었으니 코드를 살펴 보자.</p>
<p>내친 김에 플래시 메시지도 사용할 것이다. 플래시 메시지란 컨트롤러에서 세션에 구워 뷰에 전달할 메시지를 의미한다. 뷰에서는 <code>Session::get('key')</code> 로 값을 얻을 수 있다. 이 프로젝트에서는 laracasts/flash 패키지를 이용할 것이다.</p>
<pre><code class="language-bash">$ composer require "laracasts/flash:1.3.*"</code></pre>
<pre><code class="language-php">// config/app.php
'providers' =&gt; [
    ...
    Laracasts\Flash\FlashServiceProvider::class,
],
'aliases' =&gt; [
    ...
    'Flash' =&gt; Laracasts\Flash\Flash::class,
],</code></pre>
<pre><code class="language-html">&lt;!-- resources/views/layouts/master.blade.php --&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;

&lt;head&gt;
  &lt;meta charset="utf-8"&gt;
  &lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
  &lt;meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no"&gt;
  &lt;meta name="csrf-token" content="{{ csrf_token() }}" /&gt;

  &lt;title&gt;Laravel 5 Essential&lt;/title&gt;

  &lt;link href="{{ elixir("css/app.css") }}" rel="stylesheet"&gt;
  @yield('style')

  &lt;!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries --&gt;
  &lt;!--[if lt IE 9]&gt;
  &lt;script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"&gt;&lt;/script&gt;
  &lt;script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"&gt;&lt;/script&gt;
  &lt;![endif]--&gt;
&lt;/head&gt;

&lt;body&gt;
  @include('layouts.partial.navigation')

  @include('layouts.partial.flash_message')

  &lt;div class="container"&gt;
    @yield('content')
  &lt;/div&gt;

  @include('layouts.partial.footer')

  &lt;script src="{{ elixir("js/app.js") }}"&gt;&lt;/script&gt;
  @yield('script')
&lt;/body&gt;

&lt;/html&gt;</code></pre>
<p><code>@include</code> 로 하위 뷰들을 포함하고 있다. <code>&lt;meta name="csrf-token" content="{{ csrf_token() }}" /&gt;</code>는 자바스크립트에서 XHR 요청을 할 때 사용하기 위해 포함시켜 놓은 것이다 (<a href="http://laravel.com/docs/routing#csrf-protection">공식 문서 참고</a>). </p>
<pre><code class="language-html">&lt;!-- resources/views/layouts/partial/navigation.blade.php --&gt;
&lt;nav class="navbar navbar-default navbar-fixed-top" role="navigation"&gt;

  &lt;div class="container-fluid"&gt;
    &lt;div class="navbar-header"&gt;
      &lt;button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse"&gt;
        &lt;span class="sr-only"&gt;Toggle Navigation&lt;/span&gt;
        &lt;span class="icon-bar"&gt;&lt;/span&gt;
        &lt;span class="icon-bar"&gt;&lt;/span&gt;
        &lt;span class="icon-bar"&gt;&lt;/span&gt;
      &lt;/button&gt;

      &lt;a href="{{ route('home') }}" class="navbar-brand"&gt;
        &lt;img src="/images/laravel_logo.png" style="display: inline-block; height: 1.2rem;"/&gt;
      &lt;/a&gt;
    &lt;/div&gt;

    &lt;div class="collapse navbar-collapse navbar-responsive-collapse"&gt;
      &lt;ul class="nav navbar-nav navbar-right"&gt;
        @if(! auth()-&gt;check())
          &lt;li&gt;
            &lt;a href="{{ route('session.create') }}"&gt;&lt;i class="fa fa-sign-in icon"&gt;&lt;/i&gt; Login&lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;a href="{{ route('user.create') }}"&gt;&lt;i class="fa fa-certificate icon"&gt;&lt;/i&gt; Sign up&lt;/a&gt;
          &lt;/li&gt;
        @else
          &lt;li&gt;
            &lt;a href="{{ route('documents.show') }}"&gt;&lt;i class="fa fa-book icon"&gt;&lt;/i&gt; Document Viewer&lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;a href="#"&gt;&lt;i class="fa fa-weixin icon"&gt;&lt;/i&gt; Forum&lt;/a&gt;
          &lt;/li&gt;
          &lt;li&gt;
            &lt;a href="#" class="dropdown-toggle" data-toggle="dropdown"&gt;
              &lt;i class="fa fa-user icon"&gt;&lt;/i&gt; {{ auth()-&gt;user()-&gt;name }} &lt;b class="caret"&gt;&lt;/b&gt;
            &lt;/a&gt;
            &lt;ul class="dropdown-menu"&gt;
              &lt;li&gt;&lt;a href="{{ route('session.destroy') }}"&gt;&lt;i class="fa fa-sign-out icon"&gt;&lt;/i&gt; Log out&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
          &lt;/li&gt;
        @endif
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/nav&gt;</code></pre>
<p><code>@if(! auth()-&gt;check())</code> 로 로그인이 안되어 있으면 로그인과 사용자 등록 링크를, 로그인되어 있으면 메뉴들과 로그아웃 링크를 보여 주도록 뷰를 분기시키고 있다.</p>
<pre><code class="language-html">&lt;!-- resources/views/layouts/partial/flash_message.blade.php --&gt;
@if (session()-&gt;has('flash_notification.message'))
  &lt;div class="alert alert-{{ session('flash_notification.level') }} alert-dismissible flash-message" role="alert"&gt;
    &lt;button type="button" class="close" data-dismiss="alert"&gt;
      &lt;span aria-hidden="true"&gt;&amp;times;&lt;/span&gt;
      &lt;span class="sr-only"&gt;Close&lt;/span&gt;
    &lt;/button&gt;
    {{ session('flash_notification.message') }}
  &lt;/div&gt;
@endif

@if ($errors-&gt;has())
  &lt;div class="alert alert-danger alert-dismissible flash-message" role="alert"&gt;
    &lt;button type="button" class="close" data-dismiss="alert"&gt;
      &lt;span aria-hidden="true"&gt;&amp;times;&lt;/span&gt;
      &lt;span class="sr-only"&gt;Close&lt;/span&gt;
    &lt;/button&gt;
    Some errors found in the form. Please review and correct them and retry !
  &lt;/div&gt;
@endif</code></pre>
<p>첫번 째 블럭은 세션에 flash_notification으로 시작하는 값이 있으면 <a href="http://getbootstrap.com/components/#alerts">Bootstrap CSS로 나이스하게 디자인된 Alert</a>를 보여 준다. 두번째 블럭은 23강 유효성 검사에서 배운 세션에 구워 놓은 <code>$errors</code> 값이 있으면 폼을 다시 한번 체크하라고 Alert를 띄워 준다. </p>
<pre><code class="language-html">&lt;!-- resources/views/layouts/partial/footer.blade.php --&gt;
&lt;footer class="footer"&gt;
  &lt;ul class="list-inline pull-right locale"&gt;
    &lt;li&gt;&lt;i class="fa fa-language"&gt;&lt;/i&gt;&lt;/li&gt;
    &lt;li class="active"&gt;&lt;a href="#"&gt;English&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;&lt;a href="#"&gt;한국어&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;

  &lt;div&gt;
    &amp;copy; {{ date('Y') }} &amp;nbsp; &lt;a href="https://github.com/appkr/l5essential"&gt;Laravel 5 Essential&lt;/a&gt;
  &lt;/div&gt;
&lt;/footer&gt;</code></pre>
<p>다국어 지원할 것을 대비해 footer 영역에 미리 링크를 준비해 놓았다.</p>
<p>resources/views/index.blade.php, resources/views/home.blade.php 뷰 파일들은 각자의 취향에 맞게 적절한 내용을 담아 만들도록 하자.</p>
<p><img src="./images/32-login-img-02.png" alt="" /></p>
<h3>뷰를 만들자.</h3>
<p>이제 사용자 등록, 로그인, 비밀번호 초기화 폼을 만들 것인데, <code>App\Http\Controllers\Auth\AuthController</code>, <code>App\Http\Controllers\Auth\PasswordController</code> 의 메소드들에 미리 정의된 뷰의 이름들을 잘 확인하고 뷰 파일을 만들자. 필자는 기본 내장된 컨트롤러 메소드 이름이 굉장히 헷갈려서 맘에 들지 않아, 아래 테이블로 정리해 보았다.</p>
<table>
<thead>
<tr>
<th>Route</th>
<th>Route 이름</th>
<th>컨트롤러 메소드</th>
<th>연결된 뷰</th>
<th>뷰의 역할</th>
</tr>
</thead>
<tbody>
<tr>
<td>/</td>
<td>index</td>
<td>WelcomeController@index</td>
<td>index</td>
<td>인덱스 페이지</td>
</tr>
<tr>
<td>home</td>
<td>home</td>
<td>WelcomeController@home</td>
<td>home</td>
<td>로그인한 후 이동할 페이지</td>
</tr>
<tr>
<td>auth/register</td>
<td>user.create</td>
<td>AuthController@getRegister</td>
<td>auth.register</td>
<td>사용자 등록 폼</td>
</tr>
<tr>
<td>auth/login</td>
<td>session.create</td>
<td>AuthController@getLogin</td>
<td>auth.login</td>
<td>사용자 로그인 폼</td>
</tr>
<tr>
<td>auth/remind</td>
<td>reminder.create</td>
<td>PasswordController@getEmail</td>
<td>auth.password</td>
<td>비밀번호 초기화 링크 요청 이메일 발송 폼</td>
</tr>
<tr>
<td></td>
<td></td>
<td>emails.password</td>
<td>비밀번호 초기화 링크를 담은 이메일 뷰</td>
</tr>
<tr>
<td>auth/reset/{token}</td>
<td>reset.create</td>
<td>PasswordController@getReset</td>
<td>auth.reset</td>
<td>비밀번호 초기화 폼</td>
</tr>
</tbody>
</table>
<p><strong><code>참고</code></strong> <code>getRegister()</code> 메소드는 <code>Illuminate\Foundation\Auth\RegistersUsers</code> trait에서, <code>getLogin()</code> 메소드는 <code>Illuminate\Foundation\Auth\AuthenticatesUsers</code> trait에서, <code>getEmail()</code> 와 <code>getReset()</code> 메소드는 <code>Illuminate\Foundation\Auth\ResetsPasswords</code> trait에서 각각 찾아야 한다. 이들 trait들을 <code>App\Http\Controllers\Auth\AuthController</code>, <code>App\Http\Controllers\Auth\PasswordController</code>가 use 키워드로 사용하고 있다. </p>
<pre><code class="language-html">&lt;!-- resources/views/auth/register.blade.php --&gt;
@extends('layouts.master')

@section('content')
  &lt;form action="{{ route('user.store') }}" method="POST" role="form" class="form-auth"&gt;

    {!! csrf_field() !!}

    &lt;div class="page-header"&gt;
      &lt;h4&gt;Sign up&lt;/h4&gt;
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;input type="text" name="name" class="form-control" placeholder="Full name" value="{{ old('name') }}" autofocus/&gt;
      {!! $errors-&gt;first('name', '&lt;span class="form-error"&gt;:message&lt;/span&gt;') !!}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;input type="email" name="email" class="form-control" placeholder="Email address" value="{{ old('email') }}"/&gt;
      {!! $errors-&gt;first('email', '&lt;span class="form-error"&gt;:message&lt;/span&gt;') !!}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;input type="password" name="password" class="form-control" placeholder="Password, minimum 6 chars"/&gt;
      {!! $errors-&gt;first('password', '&lt;span class="form-error"&gt;:message&lt;/span&gt;') !!}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;input type="password" name="password_confirmation" class="form-control" placeholder="Confirm password" /&gt;
      {!! $errors-&gt;first('password_confirmation', '&lt;span class="form-error"&gt;:message&lt;/span&gt;') !!}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;button class="btn btn-primary btn-block" type="submit"&gt;Sign me up~&lt;/button&gt;
    &lt;/div&gt;

  &lt;/form&gt;
@stop</code></pre>
<p>스샷에서 입력값 유지, 유효성 검사, 앞 절에서 설치한 플래시메시지 등 모든 기능이 동작하는 것을 확인할 수 있다. </p>
<p><img src="./images/32-login-img-03.png" alt="" /></p>
<pre><code class="language-html">&lt;!-- resources/views/auth/login.blade.php --&gt;
@extends('layouts.master')

@section('content')
  &lt;form action="{{ route('session.store') }}" method="POST" role="form" class="form-auth"&gt;

    {!! csrf_field() !!}

    &lt;div class="page-header"&gt;
      &lt;h4&gt;Login&lt;/h4&gt;
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;input type="email" name="email" class="form-control" placeholder="Email address" value="{{ old('email') }}" autofocus/&gt;
      {!! $errors-&gt;first('email', '&lt;span class="form-error"&gt;:message&lt;/span&gt;') !!}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;input type="password" name="password" class="form-control" placeholder="Password"&gt;
      {!! $errors-&gt;first('password', '&lt;span class="form-error"&gt;:message&lt;/span&gt;')!!}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;div class="checkbox"&gt;
        &lt;label&gt;
          &lt;input type="checkbox" name="remember" value="{{ old('remember', 1) }}" checked&gt; Remember me
        &lt;/label&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;button class="btn btn-primary btn-block" type="submit"&gt;Get me in~&lt;/button&gt;
    &lt;/div&gt;

    &lt;div class="description"&gt;
      &lt;p&gt;&amp;nbsp;&lt;/p&gt;
      &lt;p class="text-center"&gt;Not a member? &lt;a href="{{ route('user.create') }}"&gt;Sign up&lt;/a&gt;&lt;/p&gt;
      &lt;p class="text-center"&gt;&lt;a href="{{ route('reminder.create')}}"&gt;Remind my password&lt;/a&gt;&lt;/p&gt;
    &lt;/div&gt;

  &lt;/form&gt;
@stop</code></pre>
<p><code>&lt;input type="checkbox" name="remember"&gt;</code> 의 값은 <code>Auth::attempt(array $credentials, bool $remember)</code> 메소드의 2번째 인자로 전달된다. 2번째 인자 없이 로그인하면 2시간동안 로그인 세션이 유지된다. 체크박스에 체크가 되어 <code>true</code> 값이 전달되면, 5년동안 로그인이 유지된다. </p>
<p><img src="./images/32-login-img-04.png" alt="" /></p>
<pre><code class="language-html">&lt;!-- resources/views/auth/password.blade.php --&gt;
@extends('layouts.master')

@section('content')
  &lt;form action="{{ route('reminder.store') }}" method="POST" role="form" class="form-auth"&gt;

    {!! csrf_field() !!}

    &lt;h4&gt;Password Remind&lt;/h4&gt;

    &lt;p class="text-muted"&gt;
      Provide the same email address that you've registered and check your email inbox to reset the password.
    &lt;/p&gt;

    &lt;div class="form-group"&gt;
      &lt;input type="email" name="email" class="form-control" placeholder="Email address" value="{{ old('email') }}" autofocus&gt;
      {!! $errors-&gt;first('email', '&lt;span class="form-error"&gt;:message&lt;/span&gt;') !!}
    &lt;/div&gt;

    &lt;button class="btn btn-primary btn-block" type="submit"&gt;Send Reminder&lt;/button&gt;

  &lt;/form&gt;
@stop</code></pre>
<p><img src="./images/32-login-img-05.png" alt="" /></p>
<pre><code class="language-html">&lt;!-- resources/views/emails/password.blade.php --&gt;
Click here to reset your password: {{ route('reset.create', $token) }}</code></pre>
<p>.env 파일에서 <code>MAIL_DRIVER=log</code>로 바꾸어 놓고, 비밀번호 초기화를 위한 이메일이 잘 나가는지 확인해 보았다.</p>
<p><img src="./images/32-login-img-06.png" alt="" /></p>
<pre><code class="language-html">&lt;!-- resources/views/auth/reset.blade.php --&gt;
@extends('layouts.master')

@section('content')
  &lt;form action="{{ route('reset.store') }}" method="POST" role="form" class="form-auth"&gt;

    {!! csrf_field() !!}

    &lt;input type="hidden" name="token" value="{{ $token }}"&gt;

    &lt;h4&gt;Reset Password&lt;/h4&gt;

    &lt;p class="text-muted"&gt;
      Provide your email address and NEW PASSWORD.
    &lt;/p&gt;

    &lt;div class="form-group"&gt;
      &lt;input type="email" name="email" class="form-control" placeholder="Email address" value="{{ old('email') }}" autofocus&gt;
      {!! $errors-&gt;first('email', '&lt;span class="form-error"&gt;:message&lt;/span&gt;') !!}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;input type="password" name="password" class="form-control" placeholder="New password"&gt;
      {!! $errors-&gt;first('password', '&lt;span class="form-error"&gt;:message&lt;/span&gt;') !!}
    &lt;/div&gt;

    &lt;div class="form-group"&gt;
      &lt;input type="password" name="password_confirmation" class="form-control" placeholder="Confirm password"&gt;
      {!! $errors-&gt;first('password_confirmation', '&lt;span class="form-error"&gt;:message&lt;/span&gt;') !!}
    &lt;/div&gt;

    &lt;button class="btn btn-primary btn-block" type="submit"&gt;Reset My Password&lt;/button&gt;

  &lt;/form&gt;
@stop</code></pre>
<p>비밀번호 초기화 이메일에서 받은 링크를 브라우저에 붙여 넣어 비밀번호를 초기화할 수 있다.</p>
<p><img src="./images/32-login-img-07.png" alt="" /></p>
<p>디자인을 위해 resources/assets/sass/app.scss 도 일부 내용이 변경되었다. 상세 설명은 생략하니, 코드를 참고하기 바란다.</p>
<!--@start-->
<hr />
<ul>
<li><a href="../readme.md">목록으로 돌아가기</a></li>
<li><a href="31-forum-features.md">31강 - 포럼 요구사항 기획</a></li>
<li><a href="33-social-login.md">33강 - 소셜 로그인</a>
<!--@end--></li>
</ul>

            <hr/>

            <nav id="pagination">
  <ul class="pager pager-bottom">
    <li class="previous ">
      <a href="/lessons/31-forum-features.html">
        <span class="pager-title-sm">
          <i class="material-icons">keyboard_arrow_left</i>
        </span>
        <span class="pager-title">
          31강 - 포럼 요구사항...
        </span>
      </a>
    </li>
    <li class="next ">
      <a href="/lessons/33-social-login.html">
        <span class="pager-title">
          33강 - 소셜 로그인
        </span>
        <span class="pager-title-sm">
          <i class="material-icons">keyboard_arrow_right</i>
        </span>
      </a>
    </li>
  </ul>
</nav>                  </article>

        <hr class="divider">

        <div id="comment">
          <div class="comments" style="margin-bottom: 30px;">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    (function() {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//l5lessons.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

  <!--script id="dsq-count-scr" src="//l5lessons.disqus.com/count.js" async></script-->
</div>        </div>
      </div>
    </div>
  </div>

  <div id="toggler">
    <a href="#" title="Open Menu">
      목록 토글
    </a>
  </div>

  <footer id="footer">
  <div>
    &copy; 2019 &nbsp; <a href="https://github.com/appkr">appkr</a> •
    Built with <a href="http://jigsaw.tighten.co/">Jigsaw</a> •
    Hosted by <a href="https://pages.github.com/">Github</a> •
    <a href="/feed.xml">Rss</a>
  </div>
</footer>

<div id="back-to-top">
  <a href="#" title="Scroll to Top">
    <i class="material-icons">keyboard_arrow_up</i>
  </a>
</div>
  <script src="/js/all.js"></script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-71112324-1', 'auto');
    ga('send', 'pageview');
  </script>
</body>
</html>
